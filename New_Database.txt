CREATE DATABASE crosswars_db

create table players
(
    id       serial
        constraint players_pk
            primary key,
    name     text not null,
    clientid text not null
);

alter table players
    owner to postgres;

create unique index players_name_uindex
    on players (name);

create table games
(
    id             serial
        constraint games_pk
            primary key,
    player_1       integer not null
        constraint games_players_id_fk
            references players,
    player_2       integer not null
        constraint games_players_id_fk2
            references players,
    gamecode       text,
    player_1_score integer default 0,
    player_2_score integer default 0
);

alter table games
    owner to postgres;

create table moves
(
    tile   integer not null,
    player integer not null
        constraint moves_players_id_fk
            references players,
    game   integer not null
        constraint moves_games_id_fk
            references games,
    value  varchar
);

alter table moves
    owner to postgres;

create index moves_tile_game_index
    on moves (tile, game);

create table words
(
    id   integer generated always as identity
        constraint words_pk
            primary key,
    word varchar,
    hint varchar
);

alter table words
    owner to postgres;

create table cross_word
(
    id                 integer generated always as identity
        constraint cross_word_pk
            primary key,
    grid_row_length    integer,
    grid_column_length integer
);

alter table cross_word
    owner to postgres;

create table cross_word_letter_placement
(
    cross_word integer
        constraint cross_word_letter_placement_cross_word_id_fk
            references cross_word,
    word       integer
        constraint cross_word_letter_placement_words_id_fk
            references words,
    letter     char,
    row        integer,
    "column"   integer
);

alter table cross_word_letter_placement
    owner to postgres;
